SELECT U.Name, U.EMail, IIF(EXISTS(SELECT Name FROM Roles JOIN UserRole ON Roles.Id = UserRole.RoleId Where UserRole.UserId = U.Id and Name = 'Admin'),1,0) as IsAdmin, IIF(EXISTS(SELECT Name FROM Roles JOIN UserRole ON Roles.Id = UserRole.RoleId Where UserRole.UserId = U.Id and Name = 'Teacher'),1,0) as IsTeacher, IIF(EXISTS(SELECT Name FROM Roles JOIN UserRole ON Roles.Id = UserRole.RoleId Where UserRole.UserId = U.Id and Name = 'Student'),1,0) as IsStudent FROM[Users] as U JOIN UserRole ON U.Id = UserRole.UserId WHERE UserRole.RoleId= 1 ORDER BY U.Name